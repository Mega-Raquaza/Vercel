import{r as n,A as v,u as j,j as o}from"./index-D4ATXNzv.js";import{l as N}from"./index-Rnf9BJUB.js";const w="http://localhost:5000",k=()=>{const{user:c}=n.useContext(v),[r,g]=n.useState(null),[d,l]=n.useState(""),[i,h]=n.useState(""),[u,t]=n.useState(""),[m,b]=n.useState("easy"),[S,f]=n.useState(""),a=j();n.useEffect(()=>{console.log("Creating socket connection for lobby...");const s=N(w,{query:{gameType:"chess",userId:c?c._id:null}});return g(s),s.on("connect",()=>{console.log("Connected to chess lobby:",s.id)}),s.on("roomCreated",e=>{console.log("roomCreated event received:",e),e&&e.roomCode&&(l(e.roomCode),t(`Room created: ${e.roomCode}. Waiting for opponent...`))}),s.on("roomJoined",e=>{console.log("roomJoined event received:",e),e&&e.roomCode&&(l(e.roomCode),t(`Joined room: ${e.roomCode}. Waiting for game to start...`))}),s.on("randomMatchFound",e=>{console.log("randomMatchFound event received:",e),e&&e.roomCode&&(l(e.roomCode),t(`Random match found: ${e.roomCode}. Game will start soon...`),setTimeout(()=>{a(`/game/chess/room/${e.roomCode}?botGame=false`)},2e3))}),s.on("botGameStarted",e=>{console.log("botGameStarted event received:",e),e&&e.roomCode&&(l(e.roomCode),f(e.color),t(`Bot game started in room: ${e.roomCode}`),setTimeout(()=>{a(`/game/chess/room/${e.roomCode}?botGame=true&playerColor=${e.color}`)},2e3))}),s.on("startGame",e=>{console.log("startGame event received:",e),e&&e.roomCode&&(t(`Game starting in room: ${e.roomCode}`),setTimeout(()=>{a(`/game/chess/room/${e.roomCode}?botGame=false`)},2e3))}),s.on("errorMessage",e=>{console.error("errorMessage event received:",e),t(e.message||"An error occurred.")}),()=>{s.disconnect(),console.log("Disconnected from chess lobby")}},[c,a]);const C=()=>{r&&(console.log("Creating chess room (for friend play)"),r.emit("createChessRoom"))},x=()=>{r&&i.trim().length===4?(console.log("Joining chess room with code:",i),r.emit("joinChessRoom",{roomCode:i})):t("Please enter a valid 4-digit room code.")},p=()=>{r&&(console.log("Finding a random chess match"),r.emit("findRandomChessMatch"),t("Searching for a random opponent..."))},y=()=>{r&&(console.log("Starting a chess game with bot at difficulty:",m),r.emit("startBotGame",{difficulty:m}),t("Starting game with bot..."))};return o.jsxs("div",{className:"max-w-5xl mx-auto p-4 min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 text-white",children:[o.jsx("h1",{className:"text-3xl font-bold mb-6 text-center",children:"Chess Lobby"}),o.jsxs("div",{className:"space-y-4 max-w-md mx-auto",children:[o.jsx("button",{onClick:p,className:"w-full p-3 bg-purple-600 rounded hover:bg-purple-500 transition font-semibold",children:"Play Random"}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("input",{type:"text",value:i,onChange:s=>h(s.target.value),placeholder:"4-digit room code",className:"flex-1 p-3 bg-gray-700 border border-gray-600 rounded-l focus:outline-none"}),o.jsx("button",{onClick:x,className:"px-4 py-3 bg-blue-600 rounded-r hover:bg-blue-500 transition font-semibold",children:"Join Room"})]}),o.jsx("button",{onClick:C,className:"w-full p-3 bg-green-600 rounded hover:bg-green-500 transition font-semibold",children:"Create Room (Play with Friend)"}),o.jsxs("div",{className:"flex flex-col space-y-2",children:[o.jsx("label",{className:"font-semibold",children:"Bot Difficulty:"}),o.jsxs("select",{value:m,onChange:s=>b(s.target.value),className:"p-2 bg-gray-700 rounded",children:[o.jsx("option",{value:"easy",children:"Easy"}),o.jsx("option",{value:"medium",children:"Medium"}),o.jsx("option",{value:"hard",children:"Hard"})]}),o.jsx("button",{onClick:y,className:"w-full p-3 bg-yellow-600 rounded hover:bg-yellow-500 transition font-semibold",children:"Play with Bot"})]})]}),u&&o.jsx("div",{className:"mt-6 max-w-md mx-auto p-3 bg-gray-800 border border-gray-700 rounded",children:o.jsx("p",{children:u})}),d&&o.jsx("div",{className:"mt-4 max-w-md mx-auto p-3 bg-gray-800 border border-gray-700 rounded",children:o.jsxs("p",{children:["Room Code: ",o.jsx("span",{className:"font-bold",children:d})]})})]})};export{k as default};
