import{r as a,j as e,A as O,a as b}from"./index-D4ATXNzv.js";const y=({achievement:s,isUnlocked:l,isClaimed:m,isLocked:i,onClaim:h,claiming:c})=>{const[n,o]=a.useState(!1),g={loser:"border-red-500",common:"border-gray-500",uncommon:"border-indigo-500",rare:"border-blue-500",mythical:"border-purple-500",legendary:"border-yellow-500"}[s.rarity]||"border-gray-500";return e.jsxs("div",{className:`p-6 rounded-lg shadow-lg transition-all duration-300 border-4 ${g} ${n?"bg-gray-900":"bg-gray-800"}`,onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),children:[!n&&e.jsxs("div",{className:"text-center",children:[i?e.jsx("i",{className:"fas fa-lock text-4xl text-gray-400 mb-2"}):e.jsx("i",{className:`${s.icon} text-4xl ${l?"text-orange-500":"text-gray-400"} mb-2`}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-1",children:s.title}),e.jsx("p",{className:"text-sm text-gray-300",children:s.description}),!l&&!i&&e.jsx("p",{className:"mt-2 text-yellow-400 font-semibold",children:"In Progress"}),i&&e.jsx("p",{className:"mt-2 text-red-400 font-semibold",children:"Locked"})]}),n&&e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Reward Details"}),e.jsxs("p",{className:"text-sm text-gray-300 mb-4",children:["+",s.rewardMedals," Medals, +",s.rewardAura," Aura"]}),l?m?e.jsx("p",{className:"text-green-400 font-semibold",children:"Reward Claimed"}):e.jsx("button",{onClick:()=>h(s._id),disabled:c,className:"px-4 py-1 bg-blue-600 rounded hover:bg-blue-700 transition text-sm",children:c?"Claiming...":"Claim Reward"}):e.jsx("p",{className:"text-gray-300 text-sm",children:"Keep working to unlock rewards!"})]})]})},p="http://localhost:5000",T=()=>{var A,k;const{user:s,refreshUserData:l}=a.useContext(O),[m,i]=a.useState([]),[h,c]=a.useState([]),[n,o]=a.useState(!0),[x,g]=a.useState(""),[_,v]=a.useState(!1),[d,$]=a.useState("rarity");if(a.useEffect(()=>{s?(async()=>{try{const r=localStorage.getItem("accessToken"),[L,R]=await Promise.all([b.get(`${p}/api/achievements`,{headers:{Authorization:`Bearer ${r}`},withCredentials:!0}),b.get(`${p}/api/achievements/unlocked`,{headers:{Authorization:`Bearer ${r}`},withCredentials:!0})]);i(L.data.achievements),c(R.data.unlockedAchievements)}catch(r){console.error("Error fetching achievements:",r),g("Error fetching achievements"),i(defaultAchievements)}finally{o(!1)}})():o(!1)},[s]),!s)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-gray-900 text-white",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4",children:"User not authenticated"}),e.jsx("p",{className:"mb-4",children:"Please log in to access the League Dashboard."}),e.jsx("button",{onClick:()=>window.location.href="/login",className:"bg-blue-600 px-4 py-2 rounded hover:bg-blue-700",children:"Go to Login"})]});const u=new Set(h.map(t=>t._id.toString())),E=new Set(((A=s==null?void 0:s.claimedAchievements)==null?void 0:A.map(t=>t.toString()))||[]),j=new Set(((k=s==null?void 0:s.achievementProgress)==null?void 0:k.map(t=>t.toString()))||[]),N={loser:0,common:1,uncommon:2,rare:3,mythical:4,legendary:5},f=[...m].sort((t,r)=>d==="title-asc"?t.title.localeCompare(r.title):d==="title-desc"?r.title.localeCompare(t.title):d==="rarity"?N[r.rarity]-N[t.rarity]:0),w=f.filter(t=>u.has(t._id.toString())),S=f.filter(t=>!u.has(t._id.toString())&&j.has(t._id.toString())),C=f.filter(t=>!u.has(t._id.toString())&&!j.has(t._id.toString())),I=async t=>{v(!0);try{const r=localStorage.getItem("accessToken");await b.post(`${p}/api/achievements/claim`,{achievementId:t},{headers:{Authorization:`Bearer ${r}`},withCredentials:!0}),await l()}catch(r){console.error("Error claiming achievement:",r),alert("Error claiming achievement")}finally{v(!1)}};return n?e.jsx("div",{className:"min-h-screen flex items-center justify-center text-white",children:"Loading achievements..."}):x?e.jsx("div",{className:"min-h-screen flex items-center justify-center text-red-500",children:x}):s?e.jsxs("div",{className:"max-w-7xl mx-auto p-4 sm:p-6 min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 text-white",children:[e.jsx("h1",{className:"text-4xl font-bold text-center mb-8",children:"Achievements"}),e.jsx("div",{className:"mb-6 flex justify-center",children:e.jsxs("select",{value:d,onChange:t=>$(t.target.value),className:"p-2 bg-gray-700 border border-gray-600 rounded text-gray-100 focus:ring focus:ring-purple-500",children:[e.jsx("option",{value:"rarity",children:"Sort by Rarity"}),e.jsx("option",{value:"title-asc",children:"Sort by Title (A-Z)"}),e.jsx("option",{value:"title-desc",children:"Sort by Title (Z-A)"})]})}),e.jsxs("div",{className:"mb-12",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4 text-green-400 text-center",children:"Completed Achievements"}),w.length>0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:w.map(t=>e.jsx(y,{achievement:t,isUnlocked:!0,isClaimed:E.has(t._id.toString()),onClaim:I,claiming:_},t._id))}):e.jsx("p",{className:"text-center text-gray-400",children:"No achievements completed yet."})]}),e.jsxs("div",{className:"mb-12",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4 text-yellow-400 text-center",children:"Ongoing Achievements"}),S.length>0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:S.map(t=>e.jsx(y,{achievement:t,isUnlocked:!1,isClaimed:!1,onClaim:()=>{},claiming:!1},t._id))}):e.jsx("p",{className:"text-center text-gray-400",children:"No ongoing achievements."})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold mb-4 text-red-500 text-center",children:"Locked Achievements"}),C.length>0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:C.map(t=>e.jsx(y,{achievement:t,isUnlocked:!1,isClaimed:!1,isLocked:!0,onClaim:()=>{},claiming:!1},t._id))}):e.jsx("p",{className:"text-center text-gray-400",children:"No locked achievements."})]})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center text-white",children:"Please log in to view achievements."})};export{T as default};
