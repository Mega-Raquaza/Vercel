import{b as j,r as s,A as k,u as C,j as o}from"./index-D4ATXNzv.js";import{l as A}from"./index-Rnf9BJUB.js";const G="http://localhost:5000",E=()=>{const{roomCode:c}=j(),{user:g}=s.useContext(k),b=C(),[l,a]=s.useState(Array(9).fill(null)),[i,u]=s.useState(!0),[m,d]=s.useState(null),[x,f]=s.useState(null),[y,h]=s.useState(null);s.useEffect(()=>{const e=A(G,{query:{roomCode:c,gameType:"tictactoe",userId:g?g._id:null}});return f(e),e.on("connect",()=>{console.log("Connected to Tic Tac Toe room:",e.id),e.emit("joinGameRoom",{roomCode:c})}),e.on("assignSymbol",t=>{console.log("Assigned symbol:",t.symbol),h(t.symbol)}),e.on("ticTacToeMove",t=>{console.log("Received move:",t),a(n=>{const r=[...n];return r[t.index]=t.player,r}),u(t.player!=="X")}),e.on("resetGame",t=>{console.log("Game reset event received with startingTurn:",t.startingTurn),a(Array(9).fill(null)),d(null),u(t.startingTurn)}),()=>{e.disconnect(),console.log("Disconnected from Tic Tac Toe room")}},[c,g]);const T=e=>{const t=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(let n=0;n<t.length;n++){const[r,w,S]=t[n];if(e[r]&&e[r]===e[w]&&e[r]===e[S])return e[r]}return null};s.useEffect(()=>{const e=T(l);e&&d(e)},[l]);const p=e=>{if(m||l[e])return;if(!y){console.log("Symbol not assigned yet. Please wait...");return}const t=i?"X":"O";if(y!==t){console.log("Not your turn!");return}const n=[...l];n[e]=t,a(n),u(!i),x&&x.emit("ticTacToeMove",{index:e,player:t,roomCode:c})},v=()=>{const e=!i;a(Array(9).fill(null)),d(null),u(e),x&&x.emit("resetGame",{roomCode:c,startingTurn:e})},N=m?`Winner: ${m}`:l.every(e=>e!==null)?"Draw":`Next: ${i?"X":"O"}`;return o.jsxs("div",{className:"max-w-5xl mx-auto p-3 sm:p-4 min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 text-white flex flex-col items-center",children:[o.jsx("h1",{className:"text-4xl font-bold mb-4",children:"Tic Tac Toe"}),o.jsxs("p",{className:"mb-2 text-xl",children:["Your symbol: ",y||"..."]}),o.jsx("p",{className:"mb-4 text-xl",children:N}),o.jsx("div",{className:"grid grid-cols-3 gap-2",children:l.map((e,t)=>o.jsx("button",{onClick:()=>p(t),className:"w-20 h-20 border border-gray-600 bg-gray-700 text-white text-3xl font-bold flex items-center justify-center",children:e},t))}),o.jsxs("div",{className:"mt-6 flex space-x-4",children:[(m||l.every(e=>e!==null))&&o.jsx("button",{onClick:v,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Reset Game"}),o.jsx("button",{onClick:()=>b(-1),className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-500 transition",children:"Back"})]})]})};export{E as default};
