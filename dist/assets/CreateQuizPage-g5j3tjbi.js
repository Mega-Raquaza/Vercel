import{r as m,j as e,a as j}from"./index-D4ATXNzv.js";import{p as S}from"./quizService-DCckhlDd.js";const g="http://localhost:5000/api/quizzes",k=["Random"],R=["Random"],E=["Random"],p=u=>u[Math.floor(Math.random()*u.length)],F=({onSubmit:u})=>{const[o,r]=m.useState({title:"Random",description:"Random",subject:"Random",randomizeQuestions:!0,difficulty:"easy",questions:[]}),[h,N]=m.useState(5),[b,l]=m.useState(""),[f,x]=m.useState(!1),d=s=>{const{name:n,value:t}=s.target;r(a=>({...a,[n]:t}))},w=(s,n)=>{const{name:t,value:a}=n.target;r(i=>{const c=[...i.questions];return c[s][t]=a,{...i,questions:c}})},v=(s,n,t)=>{const a=t.target.value;r(i=>{const c=[...i.questions];return c[s].options[n]=a,{...i,questions:c}})},y=(s,n)=>{const t=n.target.value;r(a=>{const i=[...a.questions];return i[s].options.includes(t)?(i[s].correctAnswer=t,{...a,questions:i}):(l("Correct answer must be one of the options."),a)})},q=()=>{r(s=>({...s,questions:[...s.questions,{question:"",options:["","","",""],correctAnswer:""}]}))},Q=s=>{r(n=>({...n,questions:n.questions.filter((t,a)=>a!==s)}))},C=()=>{if(!o.title||!o.description||!o.subject)return l("All fields (title, description, subject) must be filled!"),!1;if(o.questions.length===0)return l("Please generate or add at least one question."),!1;for(const s of o.questions)if(!s.question||s.options.some(n=>!n)||!s.correctAnswer)return l("Each question must have text, four options, and a correct answer."),!1;return l(""),!0},z=s=>{if(s.preventDefault(),!C())return;const n={...o,title:o.title||p(k),description:o.description||p(E),subject:o.subject||p(R),questions:o.questions.map(t=>({question:t.question,options:t.options,answer:t.correctAnswer}))};console.log("Quiz Submitted:",n),j.post(`${g}/postQuiz`,n,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}}).then(t=>{console.log("Quiz successfully posted:",t.data),u(n)}).catch(t=>{console.error("Error creating quiz:",t),l("Failed to create quiz on the server.")})},A=async()=>{x(!0),l("");try{const n=(await j.post(`${g}/generateQuiz`,{subject:o.subject,topic:o.title,description:o.description,numQuestions:h,difficulty:o.difficulty})).data.questions;if(!n||!Array.isArray(n)){l("AI did not return questions in the expected format.");return}const t=n.map(a=>({question:a.question,options:a.options||["","","",""],correctAnswer:a.answer}));r(a=>({...a,questions:t}))}catch(s){console.error("Error generating AI quiz:",s),l("Failed to generate AI quiz questions.")}finally{x(!1)}};return e.jsxs("div",{className:"max-w-3xl mx-auto p-6 bg-white shadow-lg rounded-lg",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Create a Quiz"}),b&&e.jsx("p",{className:"text-red-500 mb-4",children:b}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block font-medium",children:"Title (Topic)"}),e.jsx("input",{type:"text",name:"title",value:o.title,onChange:d,className:"w-full p-2 border rounded"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block font-medium",children:"Description"}),e.jsx("textarea",{name:"description",value:o.description,onChange:d,className:"w-full p-2 border rounded"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block font-medium",children:"Subject"}),e.jsx("input",{type:"text",name:"subject",value:o.subject,onChange:d,className:"w-full p-2 border rounded"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block font-medium",children:"Difficulty"}),e.jsxs("select",{name:"difficulty",value:o.difficulty,onChange:d,className:"w-full p-2 border rounded",children:[e.jsx("option",{value:"easy",children:"Easy"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"hard",children:"Hard"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block font-medium",children:"Number of Questions"}),e.jsx("input",{type:"number",min:"5",max:"10",value:h,onChange:s=>N(Number(s.target.value)),className:"w-full p-2 border rounded"})]}),e.jsxs("div",{className:"flex space-x-4 mb-4",children:[e.jsx("button",{onClick:A,className:"bg-purple-500 text-white px-4 py-2 rounded",disabled:f,children:f?"Generating...":"Generate AI Quiz Questions"}),e.jsx("button",{onClick:q,className:"bg-blue-500 text-white px-4 py-2 rounded",children:"Add Question Manually"})]}),o.questions.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Questions"}),o.questions.map((s,n)=>e.jsxs("div",{className:"border p-4 rounded mb-4",children:[e.jsxs("label",{className:"block font-medium",children:["Question ",n+1]}),e.jsx("input",{type:"text",name:"question",value:s.question,onChange:t=>w(n,t),className:"w-full p-2 border rounded mb-2"}),e.jsx("h4",{className:"font-medium",children:"Options"}),s.options.map((t,a)=>e.jsx("input",{type:"text",value:t,onChange:i=>v(n,a,i),className:"w-full p-2 border rounded mb-1"},a)),e.jsx("label",{className:"block font-medium mt-2",children:"Correct Answer"}),e.jsxs("select",{value:s.correctAnswer,onChange:t=>y(n,t),className:"w-full p-2 border rounded",children:[e.jsx("option",{value:"",children:"Select Correct Answer"}),s.options.map((t,a)=>e.jsx("option",{value:t,children:t},a))]}),e.jsx("button",{onClick:()=>Q(n),className:"mt-2 bg-red-500 text-white px-4 py-1 rounded",children:"Remove Question"})]},n))]}),e.jsx("button",{onClick:z,className:"bg-green-500 text-white px-4 py-2 rounded mt-4",children:"Submit Quiz"})]})},D=()=>{const u=async o=>{try{await S(o),alert("Quiz Created Successfully!")}catch(r){alert("Error creating quiz. Check console for details."),console.error(r)}};return e.jsx(F,{onSubmit:u})};export{D as default};
