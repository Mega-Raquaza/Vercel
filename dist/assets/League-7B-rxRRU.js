import{j as e,r as l,A as C,a as v}from"./index-D4ATXNzv.js";const w="http://localhost:5000",d={bronze:{requiredAura:1e3,costMedals:10},silver:{requiredAura:2500,costMedals:25},gold:{requiredAura:5e3,costMedals:50},diamond:{requiredAura:1e4,costMedals:100}},S=t=>{if(!t||t.toLowerCase()==="none")return"bronze";const r=["bronze","silver","gold","diamond"],n=r.indexOf(t.toLowerCase());return n===-1||n===r.length-1?null:r[n+1]},k=["master","diamond","gold","silver","bronze","none"];class q extends l.Component{constructor(r){super(r),this.state={hasError:!1,error:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,n){console.error("ErrorBoundary caught an error:",r,n)}render(){var r;return this.state.hasError?e.jsxs("div",{className:"max-w-5xl mx-auto p-4 min-h-screen bg-gray-900 text-white flex flex-col items-center justify-center",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4",children:"Something went wrong."}),e.jsx("p",{className:"mb-4",children:(r=this.state.error)==null?void 0:r.message}),e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-red-500 px-4 py-2 rounded hover:bg-red-600",children:"Reload Page"})]}):this.props.children}}const M=()=>{const{user:t,setUser:r}=l.useContext(C),[n,g]=l.useState(""),[b,j]=l.useState(!1),[x,L]=l.useState({}),[y,f]=l.useState(!0),[p,h]=l.useState("");if(!t)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-gray-900 text-white",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4",children:"User not authenticated"}),e.jsx("p",{className:"mb-4",children:"Please log in to access the League Dashboard."}),e.jsx("button",{onClick:()=>window.location.href="/login",className:"bg-blue-600 px-4 py-2 rounded hover:bg-blue-700",children:"Go to Login"})]});const N=(t.league||"none").toLowerCase(),o=S(N),u=()=>{if(!o||!d[o])return!1;const s=d[o];return t.aura>=s.requiredAura&&t.medals>=s.costMedals},A=async()=>{var s,a;if(!u()){g("You do not meet the requirements to advance.");return}j(!0);try{const c=localStorage.getItem("accessToken");if(!c){g("Authentication error. Please log in again.");return}const i=await v.put(`${w}/api/leagues/advance`,{},{headers:{Authorization:`Bearer ${c}`},withCredentials:!0});g(i.data.message),r(i.data.user)}catch(c){console.error("Error advancing league:",c),g(((a=(s=c.response)==null?void 0:s.data)==null?void 0:a.message)||"Error processing league action. Please try again.")}finally{j(!1)}},E=async()=>{f(!0),h("");try{const s=localStorage.getItem("accessToken");if(!s){h("Authentication error. Please log in again.");return}const a=await v.get(`${w}/api/leagues/list`,{headers:{Authorization:`Bearer ${s}`},withCredentials:!0});L(a.data.rankings)}catch(s){console.error("Error fetching league list:",s),h("Error fetching league list")}finally{f(!1)}};l.useEffect(()=>{E()},[]);const m=s=>s.charAt(0).toUpperCase()+s.slice(1);return e.jsxs("div",{className:"max-w-5xl mx-auto p-4 min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 text-white",children:[e.jsx("h1",{className:"text-4xl font-bold mb-6 text-center",children:"League Dashboard"}),e.jsxs("div",{className:"mb-8 p-6 bg-gray-800 rounded-lg shadow-lg border border-gray-700",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Your Stats"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl",children:"Aura"}),e.jsx("p",{className:"font-semibold text-2xl",children:t.aura})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl",children:"Medals"}),e.jsx("p",{className:"font-semibold text-2xl",children:t.medals})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl",children:"League"}),e.jsx("p",{className:"font-semibold text-2xl",children:m(N)})]})]})]}),o?e.jsxs("div",{className:"mb-8 p-6 bg-gray-800 rounded-lg shadow-lg border border-gray-700",children:[e.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Advance to ",m(o)," League"]}),d[o]&&e.jsxs("p",{className:"mb-4",children:["Requires Aura:"," ",e.jsx("span",{className:"font-semibold",children:d[o].requiredAura})," ","and Cost:"," ",e.jsx("span",{className:"font-semibold",children:d[o].costMedals})," Medals."]}),e.jsx("button",{onClick:A,disabled:!u()||b,className:`px-6 py-2 rounded-lg transition ${u()?"bg-green-600 hover:bg-green-500":"bg-gray-600 cursor-not-allowed"}`,children:b?"Processing...":"Advance to Next League"})]}):e.jsx("div",{className:"mb-8 p-6 bg-gray-800 rounded-lg shadow-lg border border-gray-700 text-center",children:e.jsx("p",{className:"text-lg font-bold",children:"You are at the highest league!"})}),n&&e.jsx("div",{className:"mb-8 p-6 bg-gray-800 rounded-lg shadow-lg border border-gray-700 text-center",children:e.jsx("p",{children:n})}),e.jsxs("div",{className:"mb-8 p-6 bg-gray-800 rounded-lg shadow-lg border border-gray-700",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"League Rankings"}),y?e.jsx("p",{className:"text-center",children:"Loading league list..."}):p?e.jsx("p",{className:"text-center text-red-500",children:p}):k.map(s=>e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-xl font-bold mb-2",children:[m(s)," League"]}),x[s]&&x[s].length>0?x[s].map((a,c)=>{var i;return e.jsxs("div",{className:"flex items-center p-4 bg-gray-700 rounded-lg mb-2",children:[e.jsx("div",{className:"w-10 h-10 flex-shrink-0 mr-4",children:e.jsx("img",{src:((i=a==null?void 0:a.userDetails)==null?void 0:i.profilePicture)||"https://i.pinimg.com/originals/a8/da/22/a8da222be70a71e7858bf752065d5cc3.jpg",alt:a.username,className:"w-10 h-10 rounded-full object-cover"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-bold",children:a.username}),e.jsxs("p",{className:"text-sm text-gray-300",children:["Aura: ",a.aura," | Medals: ",a.medals]})]}),e.jsxs("div",{className:"text-lg font-bold",children:["#",c+1]})]},a._id)}):e.jsx("p",{className:"text-gray-400",children:"No players in this league."})]},s))]})]})},P=()=>e.jsx(q,{children:e.jsx(M,{})});export{P as default};
