import{r as t,A as D,j as r,L as w,a}from"./index-D4ATXNzv.js";const n="http://localhost:5000",O=()=>{const{user:S}=t.useContext(D),[i,c]=t.useState("friends"),[d,v]=t.useState([]),[q,x]=t.useState(!0),[g,$]=t.useState([]),[I,m]=t.useState(!0),[o,C]=t.useState(""),[p,E]=t.useState([]),[F,b]=t.useState(!1),[f,j]=t.useState(""),[k,A]=t.useState([]),[M,y]=t.useState(!0),N=async()=>{x(!0);try{const e=await a.get(`${n}/api/friends/list`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`},withCredentials:!0});v(e.data.acceptedFriends)}catch(e){console.error("Error fetching friend list:",e),alert("Error fetching friend list")}finally{x(!1)}},l=async()=>{m(!0);try{const e=await a.get(`${n}/api/friends/requests`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`},withCredentials:!0});$(e.data.friendRequests)}catch(e){console.error("Error fetching friend requests:",e),alert("Error fetching friend requests")}finally{m(!1)}},u=async()=>{y(!0);try{const e=await a.get(`${n}/api/friends/requests/sent`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`},withCredentials:!0});A(e.data.pendingRequests)}catch(e){console.error("Error fetching sent friend requests:",e)}finally{y(!1)}},h=async(e="")=>{b(!0),j("");try{const s=await a.get(`${n}/api/friends/search?username=${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`},withCredentials:!0});E(s.data.users)}catch(s){console.error("Error fetching search results:",s),j("Error fetching users")}finally{b(!1)}};t.useEffect(()=>{N(),l(),h(),u()},[]);const P=e=>d.some(s=>s.userId._id===e),R=e=>k.includes(e),_=async e=>{try{await a.post(`${n}/api/friends/request`,{friendId:e},{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`},withCredentials:!0}),alert("Friend request sent!"),h(o),u()}catch(s){console.error("Error sending friend request:",s),alert("Error sending friend request")}},T=async e=>{try{await a.post(`${n}/api/friends/requests/${e}/accept`,{},{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`},withCredentials:!0}),l(),N(),u()}catch(s){console.error("Error accepting friend request:",s),alert("Error accepting friend request")}},L=async e=>{try{await a.post(`${n}/api/friends/requests/${e}/reject`,{},{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`},withCredentials:!0}),l()}catch(s){console.error("Error rejecting friend request:",s),alert("Error rejecting friend request")}},z=e=>{e.preventDefault(),h(o)},B=()=>r.jsxs("div",{className:"flex justify-center space-x-4 mb-8",children:[r.jsx("button",{className:`px-4 py-2 rounded ${i==="friends"?"bg-orange-500":"bg-gray-700"} text-white`,onClick:()=>c("friends"),children:"My Friends"}),r.jsx("button",{className:`px-4 py-2 rounded ${i==="requests"?"bg-orange-500":"bg-gray-700"} text-white`,onClick:()=>c("requests"),children:"Friend Requests"}),r.jsx("button",{className:`px-4 py-2 rounded ${i==="search"?"bg-orange-500":"bg-gray-700"} text-white`,onClick:()=>c("search"),children:"Search Friends"})]});return r.jsxs("div",{className:"max-w-7xl mx-auto p-6 min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 text-white",children:[r.jsx("h1",{className:"text-4xl font-bold mb-8 text-center",children:"Friends"}),B(),i==="friends"&&r.jsxs("section",{children:[r.jsx("h2",{className:"text-2xl font-bold mb-4 border-b border-gray-700 pb-2",children:"My Friends"}),q?r.jsx("p",{className:"text-center",children:"Loading friends..."}):d.length===0?r.jsx("p",{className:"text-center",children:"You have no friends yet."}):r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:d.map(e=>{var s;return r.jsxs("div",{className:"p-4 bg-gray-800 rounded-xl border border-gray-700 hover:shadow-xl transition-shadow duration-300",children:[r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsx("img",{src:((s=e.userId.userDetails)==null?void 0:s.profilePicture)||"https://i.pinimg.com/originals/a8/da/22/a8da222be70a71e7858bf752065d5cc3.jpg",alt:"Profile",className:"w-16 h-16 rounded-full object-cover border-2 border-purple-500"}),r.jsxs("div",{children:[r.jsx("p",{className:"font-bold text-white",children:e.userId.username}),r.jsxs("p",{className:"text-sm text-gray-300",children:["Aura:"," ",e.userId.aura,"| Medals:","sfds ",e.userId.medals]}),r.jsxs("p",{className:"text-sm text-gray-300",children:["League:"," ",e.userId.league]})]})]}),r.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[r.jsx(w,{to:`/profile/${e.userId._id}`,className:"text-blue-400 hover:underline text-sm",children:"View Profile"}),r.jsx(w,{to:`/chat/${e.userId._id}`,className:"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-500 transition text-sm",children:"Chat"})]})]},e._id)})})]}),i==="requests"&&r.jsxs("section",{children:[r.jsx("h2",{className:"text-2xl font-bold mb-4 border-b border-gray-700 pb-2",children:"Friend Requests"}),I?r.jsx("p",{className:"text-center",children:"Loading friend requests..."}):g.length===0?r.jsx("p",{className:"text-center text-gray-400",children:"No pending friend requests."}):r.jsx("div",{className:"space-y-4",children:g.map(e=>r.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-800 rounded-xl border border-gray-700 hover:border-purple-500 transition-all duration-300",children:[r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsx("img",{src:e.userId.profilePicture||"https://i.pinimg.com/originals/a8/da/22/a8da222be70a71e7858bf752065d5cc3.jpg",alt:"Profile",className:"w-12 h-12 rounded-full object-cover"}),r.jsx("div",{children:r.jsx("p",{className:"font-bold text-white",children:e.userId.username})})]}),r.jsxs("div",{className:"flex space-x-3",children:[r.jsx("button",{onClick:()=>T(e.userId._id),className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-500 transition",children:"Accept"}),r.jsx("button",{onClick:()=>L(e.userId._id),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-500 transition",children:"Reject"})]})]},e._id))})]}),i==="search"&&r.jsxs("section",{children:[r.jsx("h2",{className:"text-2xl font-bold mb-4 border-b border-gray-700 pb-2",children:"Search Friends"}),r.jsxs("form",{onSubmit:z,className:"flex mb-4",children:[r.jsx("input",{type:"text",placeholder:"Enter username...",value:o,onChange:e=>C(e.target.value),className:"flex-1 p-3 bg-gray-700 border border-gray-600 rounded-l focus:ring focus:ring-purple-500"}),r.jsx("button",{type:"submit",className:"p-3 bg-blue-600 text-white rounded-r hover:bg-blue-500 transition",children:"Search"})]}),F&&r.jsx("p",{children:"Loading..."}),f&&r.jsx("p",{className:"text-red-500",children:f}),p.length===0?r.jsx("p",{className:"text-center",children:"No users found."}):r.jsx("div",{className:"space-y-4",children:p.filter(e=>e._id!==S._id).map(e=>{var s;return r.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-800 rounded-xl border border-gray-700 hover:border-purple-500 transition-all duration-300",children:[r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsx("img",{src:((s=e.userDetails)==null?void 0:s.profilePicture)||"https://i.pinimg.com/originals/a8/da/22/a8da222be70a71e7858bf752065d5cc3.jpg",alt:"Profile",className:"w-12 h-12 rounded-full"}),r.jsxs("div",{children:[r.jsx("p",{className:"font-bold text-white",children:e.username}),r.jsx("p",{className:"text-sm text-gray-400",children:e.userDetails?`${e.userDetails.firstName} ${e.userDetails.lastName}`:""})]})]}),r.jsx("div",{children:P(e._id)?r.jsx("span",{className:"px-4 py-2 bg-gray-600 text-white rounded text-sm",children:"Friend"}):R(e._id)?r.jsx("span",{className:"px-4 py-2 bg-yellow-600 text-white rounded text-sm",children:"Pending"}):r.jsx("button",{onClick:()=>_(e._id),className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-500 transition text-sm",children:"Add Friend"})})]},e._id)})})]})]})};export{O as default};
