import{j as e,r as i,A as L,u as B,L as v,a as M}from"./index-D4ATXNzv.js";const w="http://localhost:5000";class T extends i.Component{constructor(s){super(s),this.state={hasError:!1,error:null}}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,c){console.error("ErrorBoundary caught an error:",s,c)}render(){var s;return this.state.hasError?e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-900 text-white p-4",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4",children:"Something went wrong."}),e.jsx("p",{className:"mb-4",children:(s=this.state.error)==null?void 0:s.message}),e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-red-600 px-4 py-2 rounded hover:bg-red-700",children:"Reload Page"})]}):this.props.children}}const U=()=>{var m,h,p,f,b,y;const{user:r,loading:s,setUser:c}=i.useContext(L),[C,d]=i.useState(!1),[l,P]=i.useState({firstName:((m=r==null?void 0:r.userDetails)==null?void 0:m.firstName)||"",lastName:((h=r==null?void 0:r.userDetails)==null?void 0:h.lastName)||"",description:((p=r==null?void 0:r.userDetails)==null?void 0:p.description)||"",profilePicture:((f=r==null?void 0:r.userDetails)==null?void 0:f.profilePicture)||""}),[a,E]=i.useState(null),[x,D]=i.useState([]),[u,n]=i.useState(""),g=B(),k=async()=>{try{const t=await M.get(`${w}/api/profile/${r._id}`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`},withCredentials:!0});E(t.data.profile),D(t.data.queries)}catch(t){console.error("Error fetching profile data:",t),n("Error fetching profile data.")}};if(!r)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-gray-900 text-white",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4",children:"User not authenticated"}),e.jsx("p",{className:"mb-4",children:"Please log in to access the League Dashboard."}),e.jsx("button",{onClick:()=>window.location.href="/login",className:"bg-blue-600 px-4 py-2 rounded hover:bg-blue-700",children:"Go to Login"})]});i.useEffect(()=>{r&&r._id&&k()},[r]);const o=t=>{P({...l,[t.target.name]:t.target.value})},S=async()=>{try{const t=localStorage.getItem("accessToken");if(!t){n("You are not authenticated. Please log in again.");return}const j=await fetch(`${w}/api/users/update`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(l)}),N=await j.json();j.ok?(c({...r,userDetails:N.userDetails}),d(!1),n("")):n(N.message||"Failed to update profile.")}catch(t){console.error("Error updating profile:",t),n("Error updating profile.")}};if(s)return e.jsx("div",{className:"min-h-screen flex items-center justify-center text-white",children:"Loading..."});if(!r)return e.jsxs("div",{className:"min-h-screen flex items-center justify-center text-white",children:["User not logged in. Please ",e.jsx(v,{to:"/login",className:"text-blue-400 underline",children:"login"}),"."]});if(!a)return e.jsx("div",{className:"min-h-screen flex items-center justify-center text-white",children:"Profile not found."});const F=a.friends?a.friends.filter(t=>t.status==="accepted").length:0;return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 p-4",children:[e.jsxs("div",{className:"max-w-3xl mx-auto bg-gray-800 p-6 rounded-lg shadow-md border border-gray-700 mb-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-6 mb-6",children:[e.jsx("img",{src:((b=a.userDetails)==null?void 0:b.profilePicture)||"https://i.pinimg.com/originals/a8/da/22/a8da222be70a71e7858bf752065d5cc3.jpg",alt:"Profile",className:"w-32 h-32 rounded-full object-cover border-4 border-purple-500"}),e.jsxs("div",{className:"flex-1 text-center md:text-left",children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:a.username}),e.jsx("p",{className:"text-gray-300",children:a.email}),e.jsxs("div",{className:"flex flex-wrap gap-4 justify-center md:justify-start mt-2",children:[e.jsxs("span",{className:"text-lg text-gray-400 flex items-center",children:[e.jsx("i",{className:"fas fa-fire text-lightBlue-400 mr-1"}),a.aura," Aura"]}),e.jsxs("span",{className:"text-lg text-gray-400 flex items-center",children:[e.jsx("i",{className:"fas fa-medal text-yellow-400 mr-1"}),a.medals," Medals"]}),e.jsxs("span",{className:"text-lg text-gray-400 flex items-center",children:[e.jsx("i",{className:"fas fa-user-friends text-green-400 mr-1"}),F," Friends"]}),e.jsxs("span",{className:"text-lg text-gray-400",children:["🏆 ",a.league]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 justify-center md:justify-start",children:[e.jsx("button",{onClick:()=>d(!0),className:"px-4 py-2 bg-gradient-to-r from-green-600 to-teal-600 text-white rounded hover:from-green-500 hover:to-teal-500 transition",children:"Edit Profile"}),e.jsx("button",{onClick:()=>g("/friends/list"),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"My Friends"}),e.jsx("button",{onClick:()=>g("/queries?status=my"),className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 transition",children:"My Queries"})]})]}),e.jsx("div",{className:"max-w-3xl mx-auto bg-gray-800 p-6 rounded-lg shadow-md border border-gray-700 mb-8",children:C?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx("input",{type:"text",name:"firstName",value:l.firstName,onChange:o,placeholder:"First Name",className:"p-2 bg-gray-700 border border-gray-600 rounded text-gray-100 focus:ring-2 focus:ring-purple-500"}),e.jsx("input",{type:"text",name:"lastName",value:l.lastName,onChange:o,placeholder:"Last Name",className:"p-2 bg-gray-700 border border-gray-600 rounded text-gray-100 focus:ring-2 focus:ring-purple-500"})]}),e.jsx("textarea",{name:"description",value:l.description,onChange:o,placeholder:"Bio",className:"w-full mt-4 p-2 bg-gray-700 border border-gray-600 rounded text-gray-100 focus:ring-2 focus:ring-purple-500"}),e.jsx("input",{type:"text",name:"profilePicture",value:l.profilePicture,onChange:o,placeholder:"Profile Picture URL",className:"w-full mt-4 p-2 bg-gray-700 border border-gray-600 rounded text-gray-100 focus:ring-2 focus:ring-purple-500"}),e.jsxs("div",{className:"flex gap-4 mt-4",children:[e.jsx("button",{onClick:S,className:"flex-1 py-2 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded hover:from-purple-500 hover:to-blue-500 transition",children:"Save Changes"}),e.jsx("button",{onClick:()=>{d(!1),n("")},className:"flex-1 py-2 bg-gray-600 text-gray-100 rounded hover:bg-gray-500 transition",children:"Cancel"})]}),u&&e.jsx("p",{className:"mt-4 text-center text-red-500",children:u})]}):e.jsx("p",{className:"text-gray-300 italic border-l-4 border-purple-500 pl-4",children:((y=a.userDetails)==null?void 0:y.description)||"This user prefers to keep an air of mystery..."})}),e.jsxs("div",{className:"max-w-3xl mx-auto bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700 mt-8",children:[e.jsx("h2",{className:"text-3xl font-bold mb-8 text-center text-white",children:"My Queries"}),x.length===0?e.jsx("p",{className:"text-center text-gray-400",children:"No queries posted yet."}):e.jsx("div",{className:"space-y-4",children:x.map(t=>e.jsx(v,{to:`/query/${t._id}`,className:"block p-4 bg-gray-700 rounded-lg border border-gray-600 hover:bg-gray-600 transition-colors",children:e.jsx("h3",{className:"text-lg font-semibold text-blue-300",children:t.title})},t._id))})]})]})},A=()=>e.jsx(T,{children:e.jsx(U,{})});export{A as default};
