import{b as h,r as l,A as C,u as v,j as e}from"./index-D4ATXNzv.js";import{l as y}from"./index-Rnf9BJUB.js";const R="http://localhost:5000",N=()=>{const{gameType:n}=h(),{user:i}=l.useContext(C),[s,u]=l.useState(null),[c,d]=l.useState(""),[m,p]=l.useState(""),[g,t]=l.useState(""),a=v();l.useEffect(()=>{const r=y(R,{query:{gameType:n,userId:i?i._id:null}});return u(r),r.on("connect",()=>{console.log("Connected to game lobby:",r.id)}),r.on("roomCreated",o=>{console.log("roomCreated event received:",o),o&&o.roomCode?(d(o.roomCode),t(`Room created: ${o.roomCode}. Waiting for players...`)):console.error("Invalid roomCreated payload",o)}),r.on("roomJoined",o=>{console.log("roomJoined event received:",o),o&&o.roomCode?(d(o.roomCode),t(`Joined room: ${o.roomCode}. Opponent found! Starting game...`),setTimeout(()=>{console.log("Redirecting to game page with roomCode:",o.roomCode),a(`/game/${n}/room/${o.roomCode}`)},2e3)):console.error("Invalid roomJoined payload",o)}),r.on("randomMatchFound",o=>{console.log("randomMatchFound event received:",o),o&&o.roomCode?(d(o.roomCode),t(`Random match found in room: ${o.roomCode}. Starting game...`),setTimeout(()=>{console.log("Redirecting to game page with roomCode:",o.roomCode),a(`/game/${n}/room/${o.roomCode}`)},2e3)):console.error("Invalid randomMatchFound payload",o)}),r.on("errorMessage",o=>{console.log("errorMessage event received:",o),t(o.message||"An error occurred")}),()=>{r.disconnect(),console.log("Disconnected from game lobby")}},[n,i,a]);const b=()=>{s&&(console.log("Emitting createRoom event for game:",n),s.emit("createRoom",{gameType:n}))},x=()=>{s&&m.trim().length===4?(console.log("Emitting joinRoom event with code:",m),s.emit("joinRoom",{roomCode:m,gameType:n})):t("Please enter a valid 4-digit code.")},f=()=>{s&&(console.log("Emitting findRandom event for game:",n),s.emit("findRandom",{gameType:n}),t("Searching for a random opponent..."))};return e.jsxs("div",{className:"max-w-5xl mx-auto p-3 sm:p-4 min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 text-white",children:[e.jsxs("h1",{className:"text-3xl font-bold mb-6 text-center",children:[n.charAt(0).toUpperCase()+n.slice(1)," Lobby"]}),e.jsxs("div",{className:"w-full max-w-md space-y-4 mb-6 mx-auto",children:[e.jsx("button",{onClick:b,className:"w-full p-3 bg-green-600 rounded hover:bg-green-500 transition font-semibold",children:"Create Room"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",value:m,onChange:r=>p(r.target.value),placeholder:"4-digit code",className:"flex-1 p-3 bg-gray-700 border border-gray-600 rounded-l focus:outline-none focus:ring-2 focus:ring-blue-600"}),e.jsx("button",{onClick:x,className:"px-4 py-3 bg-blue-600 rounded-r hover:bg-blue-500 transition font-semibold",children:"Join Room"})]}),e.jsx("button",{onClick:f,className:"w-full p-3 bg-purple-600 rounded hover:bg-purple-500 transition font-semibold",children:"Play Random"})]}),g&&e.jsx("div",{className:"w-full max-w-md mx-auto mb-6 p-3 bg-gray-800 border border-gray-700 rounded",children:e.jsx("p",{children:g})}),c&&e.jsx("div",{className:"w-full max-w-md mx-auto mb-6 p-3 bg-gray-800 border border-gray-700 rounded",children:e.jsxs("p",{children:["Your room code: ",e.jsx("span",{className:"font-bold",children:c})]})})]})};export{N as default};
