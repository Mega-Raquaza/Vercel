import{j as e,L as A,r as n,A as k,a as P}from"./index-D4ATXNzv.js";const x=({query:t,refreshQueries:h})=>{var i;const r=t.answers&&t.answers.length>0?t.answers[0]:null;return e.jsx("div",{className:"p-4 bg-gradient-to-r from-gray-800 to-gray-700 rounded-xl shadow-lg transform transition duration-300 hover:scale-105 hover:shadow-2xl",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden",children:(i=t.userDetails)!=null&&i.profilePicture?e.jsx("img",{src:t.userDetails.profilePicture,alt:`${t.username}'s avatar`,className:"object-cover w-full h-full"}):e.jsx("div",{className:"bg-gray-600 flex items-center justify-center w-full h-full",children:e.jsx("span",{className:"text-lg text-white font-bold",children:t.username?t.username.charAt(0).toUpperCase():"U"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:t.title}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Asked by: ",t.username]}),e.jsx("p",{className:"mt-1 text-gray-300 text-sm",children:t.description.length>100?t.description.substring(0,100)+"...":t.description}),e.jsxs("div",{className:"mt-2 flex items-center space-x-4 text-xs text-gray-400",children:[e.jsxs("span",{children:[e.jsx("i",{className:"fas fa-book-open mr-1"})," ",t.subject]}),e.jsxs("span",{children:[e.jsx("i",{className:"fas fa-thumbs-up mr-1"})," ",t.upvotes?t.upvotes.length:0]}),e.jsxs("span",{children:[e.jsx("i",{className:"fas fa-thumbs-down mr-1"})," ",t.downvotes?t.downvotes.length:0]})]}),r&&e.jsx("div",{className:"mt-3 p-3 bg-gray-600 rounded-md",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden bg-gray-500",children:r.profilePicture?e.jsx("img",{src:r.profilePicture,alt:"Profile",className:"object-cover w-full h-full"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("span",{className:"text-gray-200 text-xs",children:r.answeredBy?r.answeredBy.charAt(0).toUpperCase():"U"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-100 text-xs",children:r.text.length>80?r.text.substring(0,80)+"...":r.text}),e.jsx("p",{className:"text-gray-300 text-xs",children:r.answeredBy})]})]})}),e.jsx("div",{className:"mt-3",children:e.jsx(A,{to:`/query/${t._id}`,className:"inline-block text-blue-400 hover:underline text-sm transition-colors",children:"View All Answers"})})]})]})})},B="http://localhost:5000",_=()=>{const{user:t}=n.useContext(k),[h,r]=n.useState([]),[i,v]=n.useState(1),[l,m]=n.useState({subject:"",sortBy:"latest",status:"all"}),[Q,c]=n.useState(!0),u=5,y=async()=>{try{const a=(await P.get(`${B}/api/queries?page=${i}&limit=${u}`)).data;a.queries&&Array.isArray(a.queries)?(r(i===1?a.queries:N=>[...N,...a.queries]),a.totalPages?c(i<a.totalPages):c(a.queries.length===u)):Array.isArray(a)?(r(i===1?a:N=>[...N,...a]),c(a.length===u)):(console.error("Unexpected API response:",a),r([]),c(!1))}catch(s){console.error("Error fetching queries:",s),r([]),c(!1)}};if(!t)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-gray-900 text-white",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4",children:"User not authenticated"}),e.jsx("p",{className:"mb-4",children:"Please log in to access the queries."}),e.jsx("button",{onClick:()=>window.location.href="/login",className:"bg-blue-600 px-4 py-2 rounded hover:bg-blue-700",children:"Go to Login"})]});n.useEffect(()=>{y()},[i]);const o=()=>{v(1),y()};let g=(Array.isArray(h)?h:[]).filter(s=>l.subject?s.subject===l.subject:!0).sort((s,a)=>l.sortBy==="upvotes"?a.upvotes.length-s.upvotes.length:new Date(a.createdAt)-new Date(s.createdAt));const w=t?g.filter(s=>s.askedBy===t._id):[],p=t?g.filter(s=>s.askedBy!==t._id):g,f=p.filter(s=>!s.answers||s.answers.length===0),j=p.filter(s=>s.answers&&s.answers.length>0&&!s.finalAnswer),b=p.filter(s=>s.finalAnswer);let d=[];l.status!=="all"&&(l.status==="new"?d=f:l.status==="ongoing"?d=j:l.status==="completed"&&(d=b));const C=s=>s.charAt(0).toUpperCase()+s.slice(1);return e.jsxs("div",{className:"max-w-5xl mx-auto p-3 sm:p-4 min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 text-white",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-orange-400 to-pink-500",children:"Study Queries"}),e.jsxs(A,{to:"/query/new",className:"flex items-center px-4 py-2 bg-gradient-to-r from-green-600 to-teal-600 text-white rounded hover:from-green-500 hover:to-teal-500 transition-all font-semibold",children:[e.jsx("i",{className:"fas fa-plus-circle mr-2"})," Ask New Question"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2 mb-6 bg-gray-800 p-2 rounded border border-gray-700",children:[e.jsxs("select",{onChange:s=>m({...l,subject:s.target.value}),className:"p-2 bg-gray-700 border border-gray-600 rounded text-gray-100 focus:ring focus:ring-purple-500",children:[e.jsx("option",{value:"",children:"All Subjects"}),e.jsx("option",{value:"Mathematics",children:"Mathematics"}),e.jsx("option",{value:"Physics",children:"Physics"}),e.jsx("option",{value:"Biology",children:"Biology"}),e.jsx("option",{value:"Chemistry",children:"Chemistry"}),e.jsx("option",{value:"Computer Science",children:"Computer Science"}),e.jsx("option",{value:"Trivia",children:"Trivia"}),e.jsx("option",{value:"Others",children:"Others"})]}),e.jsxs("select",{onChange:s=>m({...l,sortBy:s.target.value}),className:"p-2 bg-gray-700 border border-gray-600 rounded text-gray-100 focus:ring focus:ring-purple-500",children:[e.jsx("option",{value:"latest",children:"Latest"}),e.jsx("option",{value:"upvotes",children:"Most Upvoted"})]}),e.jsxs("select",{onChange:s=>m({...l,status:s.target.value}),className:"p-2 bg-gray-700 border border-gray-600 rounded text-gray-100 focus:ring focus:ring-purple-500",children:[e.jsx("option",{value:"all",children:"All Queries"}),e.jsx("option",{value:"new",children:"New"}),e.jsx("option",{value:"ongoing",children:"Ongoing"}),e.jsx("option",{value:"completed",children:"Completed"})]}),e.jsx("div",{})]}),l.status==="all"?e.jsxs(e.Fragment,{children:[t&&w.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-3xl font-bold mb-4 text-indigo-300 flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-user"})," My Questions"]}),e.jsx("div",{className:"space-y-4",children:w.map(s=>e.jsx(x,{query:s,refreshQueries:o},s._id))})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-3xl font-bold mb-4 text-yellow-300 flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-star"})," New Queries"]}),f.length>0?e.jsx("div",{className:"space-y-4",children:f.map(s=>e.jsx(x,{query:s,refreshQueries:o},s._id))}):e.jsx("div",{className:"p-4 text-center bg-gray-800 rounded border-2 border-dashed border-gray-700",children:e.jsx("p",{className:"text-lg text-gray-400",children:"No new queries found."})})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-3xl font-bold mb-4 text-green-300 flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-sync-alt"})," Ongoing Queries"]}),j.length>0?e.jsx("div",{className:"space-y-4",children:j.map(s=>e.jsx(x,{query:s,refreshQueries:o},s._id))}):e.jsx("div",{className:"p-4 text-center bg-gray-800 rounded border-2 border-dashed border-gray-700",children:e.jsx("p",{className:"text-lg text-gray-400",children:"No ongoing queries found."})})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-3xl font-bold mb-4 text-blue-300 flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-check-circle"})," Completed Queries"]}),b.length>0?e.jsx("div",{className:"space-y-4",children:b.map(s=>e.jsx(x,{query:s,refreshQueries:o},s._id))}):e.jsx("div",{className:"p-4 text-center bg-gray-800 rounded border-2 border-dashed border-gray-700",children:e.jsx("p",{className:"text-lg text-gray-400",children:"No completed queries found."})})]})]}):e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-3xl font-bold mb-4 text-white flex items-center gap-2",children:[C(l.status)," Queries"]}),d.length>0?e.jsx("div",{className:"space-y-4",children:d.map(s=>e.jsx(x,{query:s,refreshQueries:o},s._id))}):e.jsxs("div",{className:"p-4 text-center bg-gray-800 rounded border-2 border-dashed border-gray-700",children:[e.jsx("p",{className:"text-lg text-gray-400",children:"No queries found matching your criteria."}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Be the first to ask a question!"})]})]}),Q&&e.jsx("div",{className:"flex justify-center my-4",children:e.jsx("button",{onClick:()=>v(i+1),className:"px-6 py-2 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded hover:from-purple-500 hover:to-blue-500 transition",children:"Load More"})})]})};export{_ as default};
